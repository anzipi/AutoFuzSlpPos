# This file contains all configurations for running the workflow for Fuzzy Slope Postions.
# Created by Liang-Jun Zhu, 7/18/2016


####    Required    ####
# exeDir: if the executable files' path has been exported to the environmental path, set to None
# rootDir: workspace to store results
# rawdem: input dem, be caution! DEM file should have one cell buffer. If preprocess is False, rawdem could be None.

[REQUIRED]
exeDir = D:\Compile\AutoFuzSlpPos\Release
rootDir = D:\Compile\AutoFuzSlpPos\Demo
rawdem = E:\code\DTA\AutoFuzSlpPos\data\Jamaica\Jamaica_dem.tif

####    Executable Flags    ####
# preprocess: Do preprocess for terrain attributes? True is default.
# typlocSelection: Select typical locations automatically? True is default.
# similarityInference: Calculate fuzzy membership of each slope position? True is default.
# AutoTypLocExtraction:
# ModifyExtractConfFile: Modify typical locations extracting configuration file by users (True) or automatically (False).
# AutoInfParams:
# ModifyInfConfFile: Modify the configuration file by users (True) or automatically (False).
# CalSecHardSlpPos: Calculate second harden slope positions (True) or not (False, default)
# CalSPSI: Calculate SPSI (Slope Position Sequence Index) or not, it can be True only when CalSecHardSlpPos is True.
# ExtLog: Write logfile (True, default) or not (False).

[EXECUTABLE_FLAGS]
preprocess = True
typlocSelection = True
similarityInference = True
AutoTypLocExtraction = True
ModifyExtractConfFile = False
AutoInfParams = True
ModifyInfConfFile = False
CalSecHardSlpPos = False
CalSPSI = False
ExtLog = True

####    Optional Model Parameters    ####
####  DO NOT CHANGE UNLESS AWARE WHAT THEY MEAN  ####
# mpiexecDir: if the executable files' path of MPI has been exported to the environmental path, set to None
# hostfile:  The hostfile is a text file that contains the names of hosts, the number of available slots on each host,
#            set to None if not stated.
# outlet: input outlet shapefile, be caution! The outlet point should locate at least one cell inner the DEM boundary.
#         If outlet is None, then the maximum of Contributing Area will be identified as outlet.
# VlySrc, rdgsrcInpug: Vally source and ridge source raster files respectively, they can be None.
# rpiFile: RPI (Relative Position Index) raster file, it can be user-defined or auto generated (set to None).
# inputProc: number of processor for parallel computing

[OPTIONAL]
mpiexeDir = C:\Program Files\Microsoft MPI\Bin
hostfile = None
outlet = None
vlysrc = None
rdgsrc = None
rpiFile = None
inputProc = 4

####  Optional parameters settings for terrain attributes preparation  ####
# FlowModel: 0 represents D8 flow model, and 1 represent D-infinity model (Default)
# rpiMethod: Method for Relative Position Index (RPI) calculation,
#            0 is based on Skidmore's method, and 1 is based on hydrological proximity measures (Default).
# eliminateCount: (required when rpiMethod is 0) ridge sources with very few cells will be eliminate
# SPSImethod: Valid only when CalSPSI is True, the SPSImethod could be 1,2,3
# DistanceExponentForIDW: the default is 8
# RdgTag, ShdTag, BksTag, FtsTag, VlyTag: Value representation, which can assigned the same value.
# maxMoveDist: (integer) the maximum number of grid cells that the points in the input outlet shapefile will be moved before they are saved to the output outlet shapefile
# numthresh: the number of steps to divide the search range into when looking for possible threshold values using drop analysis
# logspace: 'True' means use logarithmic spacing for threshold values, 'False' means linear spacing
# D8StreamThreshold: for D8 stream extraction from DEM, default is 0, which means the value is determined by drop analysis
# D8DownMethod: for D8DistDownToStream, it can be Horizontal, Vertical, Pythagoras and Surface, the default is 'Surface'
# D8StreamTag:for D8DistDownToStream, it should be integer, the default is 1
# D8UpMethod: for D8DistUpToRidge, it can be Horizontal, Vertical, Pythagoras and Surface, the default is 'Surface'
# D8UpStats: for D8DistUpToRidge, it can be Average, Maximum, Minimum
# DinfStreamThreshold: for Dinf stream extraction from DEM, default is 0, which means the value is equal to D8StreamThreshold
# negDinfStreamThreshold: for Dinf ridge extraction from negative DEM, default is 0, which means the value is equal to DinfStreamThreshold
# DinfDownStat: used for D-infinity distance down, Average, Maximum, Minimum, and Average is the default
# DinfDownMethod: Horizontal, Vertical, Pythagoras, Surface, and Surface is the default
# DinfDistDownWG: weight grid (full file path), the default is None
# propthresh: proportion threshold parameter where only grid cells that contribute flow with a proportion greater than this user specified threshold (t) is considered to be upslope of any given grid cell
# DinfUpStat: same as DinfDownStat
# DinfUpMethod: same as DinfDownMethod

[OPTIONAL_DTA]
FlowModel = 1
rpiMethod = 0
eliminateCount = 3
SPSImethod = 1
DistanceExponentForIDW = 8
RdgTag = 1
ShdTag = 2
BksTag = 4
FtsTag = 8
VlyTag = 16
maxMoveDist = 50
numthresh = 20
logspace = True
D8StreamThreshold = 0
D8DownMethod = Surface
D8StreamTag = 1
D8UpMethod = Surface
D8UpStats = Average
DinfStreamThreshold = 0
DinfDownStat = Average
DinfDownMethod = Surface
DinfDistDownWG = None
propthresh = 0.0
DinfUpStat = Average
DinfUpMethod = Surface

### Optional parameter-settings for Typical Locations selection  ###
# TerrainAttrDict: Terrain attributes' name used to derive fuzzy slope position.
#                  1. Built-in keywords are RPI, ProfC, HorizC, Slp, HAND, and Elev (case-insensitive).
#                  2. Among them, regional attribute (such as RPI) is required and should be in the first place,
#                     and can be replaced by rpiFile(which MUST be defined before).
#                  3. Other user-defined terrain attributes should be FULL FILE PATH!
#                  4. Values are split by comma (,)
#                  5. e.g.1., TerrainAttrDict = RPI, ProfC, Slp, HAND
#                     e.g.2., TerrainAttrDict = rpiFile, ProfC, Slp, Elev
#                     e.g.3., TerrainAttrDict = RPI, ProfC, Slp, /home/path/to/another/attribute/*.tif
#
# XXXBaseParam: Base parameters, they are:
#                                        MIN_FREQUENCY: minimal frequency of frequency distribution of terrain attributes
#                                        MIN_TYPLOC_NUM_PECENT: mininal percent of selected typical locations in RPI range defined area
#                                        MAX_TYPLOC_NUM_PERCENT: maximum percent of selected typical locations in RPI range defined area
#                                        SELECTION_MODE: whether to satisfy the minimal prototype number (0) or maximum (1)
#                                        DEFAULT_INCREMENT_RATIO: increment (or decrement) ratio when prototypes number is two small or two large
#                                        DEFAULT_SIGMA_MULTIPLIER: multiplier convert from sigma of bi-Gaussian to w parameter of FMF
#                                        MAX_LOOP_NUM_TYPLOC_SELECTION: maximum loop number in selecting typical locations
#                                        DEFAULT_BiGaussian_Ratio: ratio between left sigma and right sigma in determining FMF shape
#               e.g., RdgBaseParam = 10, 0.1, 0.3, 1, 0.1, 1.414, 50, 4.0
#
# XXXFuzInfDefault: Predefined Fuzzy Membership Function Shape, Bell-shaped, S-shaped, Z-shaped and N means Not used.
#                  1. All valid values could only be S, B, Z, and N
#                  2. More than one latter for an item is allowed, e.g., ZB
#                  3. The sequence should be consistent with TerrainAttrDict!
#
# XXXValueRanges: Value ranges of terrain attributes for extracting prototype of Ridge, Shoulder slope, Backslope, Footslope and valley.
#                  1. The basic format of a single value range is [TerrainAttrNo, value1, value2], e.g., [1, 0.99, 1.0] means for RPI the range is 0.99 ~ 1.0
#                  2. If AutoTypLocExtraction is True, only RPI ranges are needed, e.g., RdgValueRanges = [1, 0.99, 1.0]
#                  3. If AutoTypLocExtraction is False, and ModifyExtractConfFile is True,
#                     all value ranges are modified in configuration files, and do not need to modify here.
#                  4. If AutoTypLocExtraction is False, and ModifyExtractConfFile is False,
#                     all value ranges corresponding to TerrainAttrDict should be defined here,
#                     e.g., RdgValueRanges = [1, 0.99, 1.0], [3, 0.00, 1.0], [4, 200, 240]
#                  5. Single value range are enclosed by bracket, multi value ranges are split by comma (,)
#                  6. NO constraint rank for a single value range, i.e., [1, 0.99,1.0] or [1, 1.0, 0.99] are all supported.

[OPTIONAL_TYPLOC]
TerrainAttrDict = RPI, ProfC, Slp, elev

RdgBaseParam = 10, 0.1, 0.3, 1, 0.1, 1.414, 50, 4.0
ShdBaseParam = 10, 0.1, 0.3, 1, 0.1, 1.414, 50, 4.0
BksBaseParam = 10, 0.1, 0.3, 1, 0.1, 1.414, 50, 4.0
FtsBaseParam = 10, 0.1, 0.3, 1, 0.1, 1.414, 50, 4.0
VlyBaseParam = 10, 0.1, 0.3, 1, 0.1, 1.414, 50, 4.0

RdgFuzInfDefault = S, S, Z, SN
ShdFuzInfDefault = B, S, B, N
BksFuzInfDefault = B, B, S, N
FtsFuzInfDefault = B, ZB, ZB, N
VlyFuzInfDefault = Z, B, Z, N

RdgValueRanges = [1, 0.99, 1.0]
ShdValueRanges = [1, 0.9, 0.95]
BksValueRanges = [1, 0.5, 0.6]
FtsValueRanges = [1, 0.15, 0.2]
VlyValueRanges = [1, 0.0, 0.1]

### Optional parameter-settings for Fuzzy slope position inference  ###
# Default fuzzy membership function (FMF) parameters for three inference models are as follows:
# Default	w1	r1	k1	w2	r2	k2
# B(1)      6	2	0.5	6	2	0.5
# S(2)      6	2	0.5	1	0	1
# Z(3)      1	0	1	6	2	0.5
# Since r and k are determined by model shapes, only w1 and w2 values are needed for each slope position.
# XXXInferParams: w1 and w2 values of each terrain attribute for each slope position
#                  1. The basic format is [TerrainAttrNo, FMFNo, w1, w2]
#                  2. If AutoInfParams is True, just set them to []
#                  3. If AutoInfParams is False, ModifyInfConfFile is True,
#                     all parameter settings are modified in configuration files, and do not need to modify here.
#                  4. If AutoInfParams is False, and ModifyInfConfFile is False,
#                     all parameter settings corresponding to TerrainAttrDict should be defined here!
#                  5. w1 and w2 values are enclosed by bracket, and values for all terrain attributes are split by comma (,)
#                     e.g., RdgInferParams = [1, 2, 0.1, 1], [2, 2, 0.005, 1], [3, 3, 1.0, 5.0], [4, 2, 5.0, 1.0]
#                           the correspongding model shapes are S, S, Z, S
#                           and the corresponding terrain attributes are defined in TerrainAttrDict (RPI, ProfC, Slp, HAND)

[OPTIONAL_FUZINF]
RdgInferParams = []
ShdInferParams = []
BksInferParams = []
FtsInferParams = []
VlyInferParams = []
